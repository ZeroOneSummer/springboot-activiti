package com.act.activiti.util;import org.apache.http.conn.HttpClientConnectionManager;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.util.Date;import java.util.concurrent.TimeUnit;/** * 关闭HTTP空闲连接、无效连接. */public class IdleConnectionMonitorThread extends Thread {	private final static Logger logger = LoggerFactory.getLogger(IdleConnectionMonitorThread.class);	private final HttpClientConnectionManager connMgr;	private volatile boolean shutdown;		/**	 * @param connMgr	 */	public IdleConnectionMonitorThread(HttpClientConnectionManager connMgr) {		super();		this.connMgr = connMgr;	}		@Override	public void run() {		try {			while (!shutdown) {				synchronized (this) {					wait(5000);					// 关闭无效连接					connMgr.closeExpiredConnections();					// 可选, 关闭空闲超过30秒的					connMgr.closeIdleConnections(30, TimeUnit.SECONDS);					int nowMinute = DateUtil.getMinute(new Date());					if (nowMinute == 0) {						logger.info("closing expired connections and  connections idle longer than 30 SECONDS");					}				}			}		} catch (Exception ex) {			ex.printStackTrace();		}	}		public void shutdown() {		shutdown = true;		synchronized (this) {			notifyAll();		}	}	}